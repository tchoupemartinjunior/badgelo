<div class="container p-4 mx-auto flex flex-col pt-5 items-center">
    <div>
        <h1 class="text-3xl text-purple-700">Edition Photo</h1>
    </div>

    <div
        class="flex flex-col-reverse md:flex-row bg-white shadow-lg rounded-lg mx-auto justify-center w-full md:w-11/12 mt-2">

        <!-- Edition section -->
        <div
            class="w-full md:w-1/3 p-4 border-purple-200 md:border-r shadow-lg rounded-lg flex flex-col justify-between">
            <div class="border-b border-gray-200 mb-4">
                <nav class="-mb-px flex gap-6">
                    @for(tab of tabs; track tab.index) {
                    <button (click)="activeTab = tab.key"
                        class="border-b-2 px-1 pb-2 text-sm font-medium hover:cursor-pointer" [ngClass]="activeTab === tab.key 
                ? 'border-purple-600 text-purple-600' 
                : 'border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700'">
                        {{ tab.label }}
                    </button>
                    }
                </nav>
            </div>
            <div class="flex-grow">
                @switch(activeTab) {
                @case('photo') {
                <bdge-photo-editor />
                }

                @case('badge') {
                <bdge-badge-editor />
                }
                }
            </div>

            <div class="mt-4 flex justify-start">
                <bdge-button text="Réinitialiser les modifications" [bgColor]="'bg-gray-700'"
                    [onHoverBgColor]="'bg-gray-500'" (onClick)="editorStateService.resetEditor()"></bdge-button>
            </div>
        </div>


        <!-- Preview section -->
        <div class="w-full md:w-2/3 p-4 flex flex-col items-center bg-gray-50">
            <h2>Aperçu de l'image</h2>

            @if(!editorStateService.hasChanges()) {
            <bdge-preview></bdge-preview>
            }
            <canvas [hidden]="!editorStateService.hasChanges()" class="h-100 w-full object-contain" #canvas></canvas>



            <div class="flex flex-col sm:flex-row gap-4 mt-4 justify-center items-center">
                <bdge-upload-button [backgroundColor]="'bg-gray-700'" (fileSelected)="fileService.upload($event)">
                </bdge-upload-button>

                <bdge-button text="Téléchargez l'image" (onClick)="fileService.download()">
                </bdge-button>
            </div>
        </div>
    </div>

</div>